<div class="traits">
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.Size"}}</strong><br/>@data.traits.size">
        <label>{{localize "SFRPG.Size"}}</label>
        {{#if (not isDrone)}}
        <select class="actor-size" name="data.traits.size">
            {{#select data.traits.size}}
            {{#each config.actorSizes as |label size|}}
                <option value="{{size}}">{{label}}</option>
            {{/each}}
            {{/select}}
        </select>
        {{else}}
        <span class="value">{{data.traits.size}}</span>
        {{/if}}
    </div>

    {{#if (not isDrone)}}
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.KeyAbility"}}</strong><br/>@data.attributes.keyability">
        <label>{{localize "SFRPG.KeyAbility"}}</label>
        <select class="actor-keyability" name="data.attributes.keyability">
            {{#select data.attributes.keyability}}
            <option value="">Choose One</option>
            {{#each config.abilities as |label abl|}}
                <option value="{{abl}}">{{label}}</option>
            {{/each}}
            {{/select}}
        </select>
    </div>
    {{/if}}

    <div class="form-group {{#unless data.traits.senses}}inactive{{/unless}}" data-tippy-content="<strong>{{localize "SFRPG.Senses"}}</strong><br/>@data.traits.senses">
        <label>{{localize "SFRPG.Senses"}}</label>
        {{#if (not isDrone)}}
        <input type="text" name="data.traits.senses" value="{{data.traits.senses}}" placeholder="{{localize "SFRPG.None"}}"/>
        {{else}}
        <span class="value">{{data.traits.senses}}</span>
        {{/if}}
    </div>

    {{#if (not isDrone)}}
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.NumberOfArms"}}</strong><br/>@data.attributes.arms">
        <label>{{localize "SFRPG.NumberOfArms"}}</label>
        <input type="text" name="data.attributes.arms" value="{{data.attributes.arms}}" placeholder="2" />
    </div>
    
    {{#if isCharacter}}
    <div class="form-group" {{createTippy title="SFRPG.ActorSheet.Traits.MagicalItems" subtitle="@magicalItems.worn<br/>@magicalItems.max" tooltips=data.magicalItems.tooltip}}>
        <label>{{localize "SFRPG.ActorSheet.Traits.MagicalItems"}}</label>
        <span type="text" {{#if (gt data.magicalItems.worn data.magicalItems.max)}}class="error"{{/if}} style="text-align: center;">{{data.magicalItems.worn}}</span>
        <span class="sep">/</span>
        <span type="text" style="text-align: center;">{{data.magicalItems.max}}</span>
    </div>
    {{/if}}

    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.Space"}}</strong><br/>@data.attributes.space">
        <label>{{localize "SFRPG.Space"}}</label>
        <input type="text" name="data.attributes.space" value="{{data.attributes.space}}" placeholder="5" />
    </div>
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.Reach"}}</strong><br/>@data.attributes.reach">
        <label>{{localize "SFRPG.Reach"}}</label>
        <input type="text" name="data.attributes.reach" value="{{data.attributes.reach}}" placeholder="0" />
    </div>
    {{else}}
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.DroneSheet.Traits.GeneralPurposeArms"}}</strong><br/>@data.attributes.arms">
        <label>{{localize "SFRPG.DroneSheet.Traits.GeneralPurposeArms"}}</label>
        <span class="value">{{data.attributes.arms}}</span>
    </div>
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.DroneSheet.Traits.MeleeWeaponMounts"}}</strong><br/>@data.attributes.weaponMounts.melee.max">
        <label>{{localize "SFRPG.DroneSheet.Traits.MeleeWeaponMounts"}}</label>
        <span class="value">{{data.attributes.weaponMounts.melee.max}}</span>
    </div>
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.DroneSheet.Traits.RangedWeaponMounts"}}</strong><br/>@data.attributes.weaponMounts.ranged.max">
        <label>{{localize "SFRPG.DroneSheet.Traits.RangedWeaponMounts"}}</label>
        <span class="value">{{data.attributes.weaponMounts.ranged.max}}</span>
    </div>
    {{/if}}
    
    {{#if isDrone}}
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.SFRPG.DroneSheet.Traits.ArmorSlots"}}</strong><br/>@data.attributes.armorSlots.current<br/>@data.attributes.armorSlots.max">
        <label>{{localize "SFRPG.DroneSheet.Traits.ArmorSlots"}}</label>
        <span class="value">{{data.attributes.armorSlots.current}}</span>
        <span class="sep">/</span>
        <span class="value">{{data.attributes.armorSlots.max}}</span>
    </div>
    {{/if}}

    {{#if (not isDrone)}}
    <div class="form-group {{data.traits.languages.cssClass}}">
        <label for="data.traits.languages">{{localize "SFRPG.Languages"}}</label>
        <ul class="traits-list">
        {{#each data.traits.languages.selected as |v k|}}
            <li class="tag {{k}}">{{v}}</li>
        {{/each}}
        </ul>
        <a class="trait-selector" data-options="languages"><i class="fas fa-edit"></i></a>
    </div>
    {{/if}}
    
    {{#if (not isDrone)}}
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.SpellResistance"}}</strong><br/>@data.traits.sr">
        <label>{{localize "SFRPG.SpellResistance"}}</label>
        <input type="text" name="data.traits.sr" value="{{data.traits.sr}}" data-dtype="Number" />
    </div>
    {{else}}
    <div class="form-group" {{createTippy title="SFRPG.SpellResistance" subtitle="@traits.spellResistance.value" tooltips=data.traits.spellResistance.tooltip}}>
        <label>{{localize "SFRPG.SpellResistance"}}</label>
        <span class="value">{{data.traits.spellResistance.value}}</span>
    </div>
    {{/if}}
    
    <div class="form-group damage-reduction" {{createTippy title="SFRPG.Damage.Reduction" subtitle="@traits.damageMitigation.damageReductionFirst.value<br/>@traits.damageMitigation.damageReductionFirst.negatedBy" tooltips=data.traits.damageMitigation.damageReductionTooltip}}>
        <label>{{localize "SFRPG.Damage.Reduction"}}</label>
        {{#if data.traits.damageMitigation.damageReductionFirst}}
            {{#with data.traits.damageMitigation.damageReductionFirst}}
            <span type="text" style="text-align: center;">{{value}}</span>
            <span class="sep">/</span>
            <span type="text" style="text-align: center;">
                {{#if (eq negatedBy "")}}
                    -
                {{else}}
                    {{#if (lookup ../config.damageReductionTypes negatedBy)}}
                        {{lookup ../config.damageReductionTypes negatedBy}}
                    {{else}}
                        {{negatedBy}}
                    {{/if}}
                {{/if}}
            </span>
            {{/with}}
        {{else}}
        <span type="text" style="text-align: center;">0</span>
        <span class="sep">/</span>
        <span type="text" style="text-align: center;">-</span>
    {{/if}}
    </div>

    <div class="form-group {{data.traits.dr.cssClass}}">
        <label for="data.traits.dr">{{localize "SFRPG.Damage.Resistances"}}</label>
        <ul class="traits-list">
        {{#each data.traits.damageMitigation.energyResistance as |erModifier damageType|}}
            {{#if (eq damageType "custom")}}
            <li class="tag {{damageType}}">{{erModifier.source.notes}} {{erModifier.value}}</li>
            {{else}}
                <li class="tag {{damageType}}">{{lookup ../config.energyResistanceTypes damageType}} {{erModifier.value}}</li>
            {{/if}}
        {{/each}}
        </ul>
    </div>

    {{#if (not isDrone)}}
    <div class="form-group {{data.traits.dv.cssClass}}">
        <label for="data.traits.dv">{{localize "SFRPG.Damage.Vulnerabilities"}}</label>
        <ul class="traits-list">
        {{#each data.traits.dv.selected as |v k|}}
            <li class="tag {{k}}">{{v}}</li>
        {{/each}}
        </ul>
        <a class="trait-selector" data-options="damageTypes"><i class="fas fa-edit"></i></a>
    </div>

    <div class="form-group {{data.traits.di.cssClass}}">
        <label for="data.traits.di">{{localize "SFRPG.Damage.Immunities"}}</label>
        <ul class="traits-list">
        {{#each data.traits.di.selected as |v k|}}
            <li class="tag {{k}}">{{v}}</li>
        {{/each}}
        </ul>
        <a class="trait-selector" data-options="damageTypes"><i class="fas fa-edit"></i></a>
    </div>

    <div class="form-group {{data.traits.ci.cssClass}}">
        <label for="data.traits.ci">{{localize "SFRPG.ConImm"}}</label>
        <ul class="traits-list">
        {{#each data.traits.ci.selected as |v k|}}
            <li class="tag {{k}}">{{v}}</li>
        {{/each}}
        </ul>
        <a class="trait-selector" data-options="conditionTypes"><i class="fas fa-edit"></i></a>
    </div>
    {{/if}}

    {{#if (or isCharacter isDrone)}}
        <div class="form-group {{data.traits.weaponProf.cssClass}}">
            <label for="data.traits.weaponProf">{{localize "SFRPG.TraitWeaponProf"}}</label>
            <ul class="traits-list">
            {{#each data.traits.weaponProf.selected as |v k|}}
                <li class="tag {{k}}">{{v}}</li>
            {{/each}}
            </ul>
            <a class="trait-selector" data-options="weaponProficiencies"><i class="fas fa-edit"></i></a>
        </div>

        {{#if isCharacter}}
        <div class="form-group {{data.traits.armorProf.cssClass}}">
            <label for="data.traits.armorProf">{{localize "SFRPG.TraitArmorProf"}}</label>
            <ul class="traits-list">
            {{#each data.traits.armorProf.selected as |v k|}}
                <li class="tag {{k}}">{{v}}</li>
            {{/each}}
            </ul>
            <a class="trait-selector" data-options="armorProficiencies"><i class="fas fa-edit"></i></a>
        </div>
        {{/if}}
    {{/if}}

    {{#if isNPC}}
    <div class="form-group" data-tippy-content="<strong>{{localize "SFRPG.NPCSheet.Header.AuraPlaceHolderText"}}</strong><br/>@data.details.aura">
        <label>{{localize "SFRPG.NPCSheet.Header.AuraPlaceHolderText"}}</label>
        <input type="text" name="data.details.aura" value="{{data.details.aura}}" />
    </div>
    <div class="form-group" {{createTippy title="SFRPG.NPCSheet.Header.AbilityDC" subtitle="@attributes.abilityDC.value" tooltips="SFRPG.NPCSheet.Header.AbilityDCTooltip"}}>
        <label>{{localize "SFRPG.NPCSheet.Header.AbilityDC"}}</label>
        <input type="text" name="data.attributes.abilityDC.base" value="{{data.attributes.abilityDC.base}}" placeholder="0"/>
    </div>
    <div class="form-group" {{createTippy title="SFRPG.NPCSheet.Header.BaseSpellDC" subtitle="@attributes.baseSpellDC.value" tooltips="SFRPG.NPCSheet.Header.BaseSpellDCTooltip"}}>
        <label>{{localize "SFRPG.NPCSheet.Header.BaseSpellDC"}}</label>
        <input type="text" name="data.attributes.baseSpellDC.base" value="{{data.attributes.baseSpellDC.base}}" placeholder="0"/>
    </div>
    {{/if}}
    
    {{#if (not isDrone)}}
    <div class="form-group ">
        <label>{{localize "SFRPG.SpecialTraits"}}</label>
        <a class="configure-flags"><i class="fas fa-cog"></i></a>
    </div>
    {{/if}}
</div>